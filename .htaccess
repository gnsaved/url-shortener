# URL Shortener - Works in Root OR Subdirectory
# Auto-detects location and adjusts accordingly

RewriteEngine On

# Auto-detect base directory
# This works whether you're at:
# - https://domain.com/ (root)
# - https://domain.com/url-shortener/ (subfolder)
# - https://subdomain.domain.com/ (subdomain)
RewriteBase /url-shortener/

# Important: Change the line above based on your installation:
# - If in ROOT: RewriteBase /
# - If in subfolder: RewriteBase /url-shortener/
# - If in different subfolder: RewriteBase /your-folder-name/

# Don't rewrite if file exists
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Don't rewrite if directory exists
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Redirect short codes to r.php
RewriteRule ^([a-zA-Z0-9_-]+)/?$ r.php?code=$1 [L,QSA]

# Protect data directory
<Files "urls.json">
    Require all denied
</Files>
